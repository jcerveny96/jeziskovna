<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Detail zásilky | Dárkovna</title>
  <link rel="stylesheet" href="style.css">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <style>
    .layout {
      display: grid;
      grid-template-columns: 1fr 1.2fr;
      gap: 32px;
    }

    .box {
      background: #fff;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .label {
      color: #777;
      font-size: 13px;
      margin-top: 16px;
    }

    .value {
      font-size: 16px;
      margin-top: 4px;
    }

    /* Timeline */
    .timeline {
      position: relative;
      margin-left: 20px;
    }

    .timeline::before {
      content: "";
      position: absolute;
      left: 6px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #ddd;
    }

    .event {
      position: relative;
      margin-bottom: 24px;
      padding-left: 24px;
    }

    .event::before {
      content: "";
      position: absolute;
      left: -2px;
      top: 4px;
      width: 12px;
      height: 12px;
      background: #bbb;
      border-radius: 50%;
    }

    .event.active::before {
      background: #e6007e;
    }

    .event-title {
      font-weight: bold;
    }

    .event-time {
      font-size: 13px;
      color: #777;
      margin-top: 4px;
    }

    #map {
      height: 300px;
      margin-top: 32px;
      border-radius: 8px;
    }

    @media (max-width: 800px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<header class="header">
  <h1>Dárkovna</h1>
</header>

<main class="container" id="content">
  Načítání zásilky…
</main>

<script src="data.js"></script>
<script>
  const params = new URLSearchParams(window.location.search);
  const code = params.get("code");
  const shipment = shipments[code];
  const content = document.getElementById("content");

  if (!shipment) {
    content.innerHTML = `
      <h2>Zásilka nenalezena</h2>
      <p>Zkontrolujte prosím zadané číslo zásilky.</p>
    `;
  } else {
    content.innerHTML = `
      <h2>Zásilka ${code}</h2>

      <div class="layout">
        <!-- LEVÝ SLOUPEC -->
        <div class="box">
          <div class="label">Obsah zásilky</div>
          <div class="value">${shipment.name}</div>

          <div class="label">Odesláno z depa</div>
          <div class="value">${shipment.sentFrom}<br>${shipment.sentAt}</div>

          <div class="label">Očekávané doručení</div>
          <div class="value">${shipment.eta}</div>
        </div>

        <!-- PRAVÝ SLOUPEC -->
        <div class="box">
          <div class="timeline">
            <div class="event">
              <div class="event-title">Zásilka převzata do přepravy</div>
              <div class="event-time">${shipment.sentAt}</div>
            </div>

            <div class="event">
              <div class="event-title">Doručena na depo ${shipment.lastSeen}</div>
              <div class="event-time">${shipment.lastSeenAt}</div>
            </div>

            <div class="event">
              <div class="event-title">Převezeno na kole do Depa Brussels ${shipment.lastSeenAfter}</div>
              <div class="event-time">${shipment.lastSeenAfterAt}</div>
            </div>

            <div class="event active">
              <div class="event-title">Zásilka doručena do Depa Bratislava</div>
              <div class="event-time">čeká na převzetí z depa</div>
            </div>

            <div class="event">
              <div class="event-title">Očekávané doručení</div>
              <div class="event-time">${shipment.eta}</div>
            </div>
          </div>
        </div>
      </div>

      <div id="map"></div>
    `;

    const map = L.map('map').setView([shipment.lat, shipment.lng], 11);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    L.marker([shipment.lat, shipment.lng]).addTo(map);
  }
</script>

</body>
</html>
